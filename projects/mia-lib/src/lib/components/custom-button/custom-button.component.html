<ng-container [ngSwitch]="variant">
  <button
    *ngSwitchCase="'basic'"
    mat-button
    [class]="buttonClass"
    [disabled]="disabled || loading"
  >
    <ng-container *ngTemplateOutlet="baseTemplate"></ng-container>
  </button>
  <button
    *ngSwitchCase="'flat'"
    mat-flat-button
    color="primary"
    [class]="buttonClass"
    [disabled]="disabled || loading"
  >
    <ng-container *ngTemplateOutlet="baseTemplate"></ng-container>
  </button>
  <button
    *ngSwitchCase="'outline'"
    mat-stroked-button
    [class]="buttonClass"
    [disabled]="disabled || loading"
  >
    <ng-container *ngTemplateOutlet="baseTemplate"></ng-container>
  </button>
  <button
    *ngSwitchCase="'icon'"
    mat-icon-button
    [class]="buttonClass"
    [disabled]="disabled || loading"
    data-toggle="tooltip"
    [title]="tooltip"
  >
    <ng-container *ngTemplateOutlet="iconTemplate"></ng-container>
  </button>
</ng-container>

<ng-template #baseTemplate>
  <ng-container *ngIf="loading; else notLoading">
    <!-- passed template while loading -->
    <ng-container
      *ngTemplateOutlet="icon?.template || defaultLoader"
    ></ng-container>
    <ng-template #defaultLoader>
      <mat-icon>
        <mat-spinner diameter="20" color="accent"> </mat-spinner>
      </mat-icon>
    </ng-template>
  </ng-container>
  <ng-template #notLoading>
    <!-- default label -->
    <ng-content></ng-content>
  </ng-template>
</ng-template>

<ng-template #iconTemplate>
  <mat-icon class="top-0" [class]="iconClass">
    <ng-content select="[icon]"> </ng-content>
  </mat-icon>
</ng-template>
