<ng-container [ngSwitch]="variant">
  <button
    *ngSwitchCase="'basic'"
    mat-button
    [class]="buttonClass"
    [disabled]="disabled || loading"
  >
    <ng-container *ngTemplateOutlet="baseTemplate"></ng-container>
  </button>
  <button
    *ngSwitchCase="'flat'"
    mat-flat-button
    color="primary"
    [class]="buttonClass"
    [disabled]="disabled || loading"
  >
    <ng-container *ngTemplateOutlet="baseTemplate"></ng-container>
  </button>
  <button
    *ngSwitchCase="'outline'"
    mat-stroked-button
    [class]="buttonClass"
    [disabled]="disabled || loading"
  >
    <ng-container *ngTemplateOutlet="baseTemplate"></ng-container>
  </button>
  <button
    *ngSwitchCase="'icon'"
    mat-icon-button
    [class]="buttonClass"
    [disabled]="disabled || loading"
    data-toggle="tooltip"
    [title]="tooltip"
  >
    <i [style.line-height]="'unset'" class="mdi" [class]="iconClass"></i>
  </button>
</ng-container>

<ng-template #baseTemplate>
  <ng-container *ngIf="loading; else notLoading">
    <!-- passed template while loading -->
    <ng-container
      *ngTemplateOutlet="icon?.template || defaultLoader"
    ></ng-container>
    <ng-template #defaultLoader>
      <i class="mdi mdi-loading mdi-spin mdi-18px text-white"></i>
    </ng-template>
  </ng-container>
  <ng-template #notLoading>
    <!-- default label -->
    <ng-content></ng-content>
  </ng-template>
</ng-template>
