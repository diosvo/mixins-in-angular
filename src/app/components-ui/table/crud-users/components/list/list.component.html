<ng-container *ngIf="state$ | async as state">
  <alert-message *ngIf="state.error" type="error">
    {{ state.error }}
  </alert-message>

  <custom-table
    [data]="state.data | filter: query.value"
    [columns]="columns"
    [highlight]="query.value"
    [defaultSortColumn]="'name'"
  >
    <div header class="d-flex ai-baseline jc-between">
      <h2>List Users</h2>
      <custom-button variant="flat" (click)="onBulk({})">
        Create User
      </custom-button>
    </div>

    <custom-input
      filters
      class="flex-1"
      label="search"
      [clearFilter]="true"
      [formControl]="query"
    >
    </custom-input>

    <custom-column columnName="actions">
      <ng-template let-user let-index="index">
        <custom-button
          variant="icon"
          tooltip="Edit"
          iconClass="f-16"
          [disabled]="state.loading"
          (click)="onBulk(user)"
        >
          <ng-container icon>edit</ng-container>
        </custom-button>
        <custom-button
          variant="icon"
          tooltip="Delete"
          iconClass="f-16"
          [disabled]="state.loading"
          (click)="onDelete(user)"
        >
          <ng-container icon>delete_outline</ng-container>
        </custom-button>
      </ng-template>
    </custom-column>

    <ng-container noData>
      <ng-container *ngIf="state.loading; else notFound">
        <div class="text-center m-2">Loading ...</div>
      </ng-container>
      <ng-template #notFound>
        <no-results (resetFilters)="query.setValue('')"></no-results>
      </ng-template>
    </ng-container>
  </custom-table>
</ng-container>
