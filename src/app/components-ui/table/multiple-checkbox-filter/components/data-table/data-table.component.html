<div class="bg-white bd-auto width-100 p-3">
  <div [style]="{ display: (service.error$ | async) ? 'block' : 'none' }">
    <div class="text-center text-error">
      Something went wrong. Please try again.
    </div>
  </div>

  <div [style]="{ display: (service.error$ | async) ? 'none' : 'block' }">
    <search-filter></search-filter>

    <div class="position-relative table-container">
      <div
        *ngIf="isLoadingResults || isRateLimitReached"
        class="
          position-absolute
          width-100
          height-100
          z-index-1
          d-flex
          ai-center
          jc-center
          loading-shade
        "
      >
        <mat-spinner *ngIf="isLoadingResults"></mat-spinner>
        <div class="text-center text-error" *ngIf="isRateLimitReached">
          GitHub's API rate limit has been reached. It will be reset in one
          minute.
        </div>
      </div>

      <table
        mat-table
        [dataSource]="data"
        class="width-100"
        matSort
        matSortActive="created"
        matSortDisableClear
        matSortDirection="desc"
      >
        <ng-container matColumnDef="created">
          <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>
            Created
          </th>
          <td mat-cell *matCellDef="let row">{{ row.created_at | date }}</td>
        </ng-container>

        <ng-container matColumnDef="state">
          <th mat-header-cell *matHeaderCellDef>State</th>
          <td mat-cell *matCellDef="let row">{{ row.state }}</td>
        </ng-container>

        <ng-container matColumnDef="number">
          <th mat-header-cell *matHeaderCellDef>#</th>
          <td mat-cell *matCellDef="let row">{{ row.number }}</td>
        </ng-container>

        <ng-container matColumnDef="title">
          <th mat-header-cell *matHeaderCellDef>Title</th>
          <td mat-cell *matCellDef="let row">{{ row.title }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>

    <mat-paginator [length]="resultsLength" [pageSize]="30"></mat-paginator>
  </div>
</div>
